{"version":3,"file":"Header.39eb3acf.js","sources":["../../src/contexts/SchoolsContext.tsx","../../src/hooks/useSchools.tsx","../../src/components/Header.tsx"],"sourcesContent":["import { getAuth, GoogleAuthProvider, signInWithPopup } from \"firebase/auth\";\nimport {\n  collection,\n  deleteDoc,\n  doc,\n  getDocs,\n  query,\n  serverTimestamp,\n  setDoc,\n  where,\n} from \"firebase/firestore\";\nimport { createContext, ReactNode, useEffect, useState } from \"react\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { useNavigate } from \"react-router-dom\";\nimport { auth, db } from \"../services/firebaseConfig\";\n\ninterface SchoolsProps {\n  schoolName: string;\n  userId: string;\n  address: string;\n  schoolId: string | undefined;\n}\n\nexport interface SchoolsContextDataProps {\n  user: any;\n  schoolData: SchoolsProps[];\n  isLoading: boolean;\n  handleWithSchoolDataFromDb: (userId: string | undefined) => void;\n  handleDeleteSchoolFromDB: (schoolId: any) => void;\n}\n\ninterface SchoolsProviderProps {\n  children: ReactNode;\n}\n\nexport const SchoolsContext = createContext({} as SchoolsContextDataProps);\n\nexport function SchoolsContextProvider({ children }: SchoolsProviderProps) {\n  const [user] = useAuthState(auth);\n  const [isLoading, setIsLoading] = useState(false);\n  const [schoolData, setSchoolData] = useState<SchoolsProps[]>([]);\n\n  async function handleWithSchoolDataFromDb(userId: string | undefined) {\n    const docCollectionRef = collection(db, \"schools\");\n    const q = query(docCollectionRef, where(\"userId\", \"==\", `${userId}`));\n    const querySnapshot = await getDocs(q);\n    setSchoolData([])\n    querySnapshot.forEach((doc) => {\n      setSchoolData((prev) => [\n        ...prev,\n        {\n          schoolName: doc.data().schoolName,\n          userId: doc.data().userId,\n          address: doc.data().address,\n          schoolId: doc.data().schoolId,\n        },\n      ]);\n    });\n  }\n\n  async function handleDeleteSchoolFromDB(schoolId: any) {\n    setIsLoading(true);\n    const schoolDelete = await deleteDoc(doc(db, \"schools\", schoolId));\n    console.log(\"Excluindo escola\", schoolId);\n    alert(\"Escola excluida\");\n    handleWithSchoolDataFromDb(user?.uid);\n    location.replace(\"/\");\n    setIsLoading(false);\n  }\n\n  useEffect(() => {\n    if (user) {\n      setSchoolData([]);\n      handleWithSchoolDataFromDb(user?.uid);\n    } else {\n    }\n  }, [user]);\n\n  return (\n    <SchoolsContext.Provider\n      value={{\n        user,\n        isLoading,\n        schoolData,\n        handleWithSchoolDataFromDb,\n        handleDeleteSchoolFromDB,\n      }}\n    >\n      {children}\n    </SchoolsContext.Provider>\n  );\n}\n","import { useContext } from \"react\";\n\nimport {SchoolsContext, SchoolsContextDataProps} from '../contexts/SchoolsContext'\n\nexport function useSchool(): SchoolsContextDataProps {\n\n  const context = useContext(SchoolsContext);\n  \n  return context;\n}","import { signOut } from \"firebase/auth\";\nimport { useEffect } from \"react\";\nimport { useAuthState } from \"react-firebase-hooks/auth\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { useUser } from \"../hooks/useUser\";\nimport { auth } from \"../services/firebaseConfig\";\nimport { Button } from \"./Button\";\nimport { Heading } from \"./Heading\";\nimport { Loading } from \"./Loading\";\nimport { Text } from \"./Text\";\n\nexport function Header() {\n  const [user] = useAuthState(auth);\n  const { userData } = useUser();\n  const navigate = useNavigate();\n  const logout = () => {\n    signOut(auth);\n    navigate(\"/\");\n  };\n\n  if (userData?.photoURL === auth.currentUser?.photoURL) {\n    return (\n      <div className=\"flex w-full items-center justify-between gap-4 p-4 border-b-2 border-green-500\">\n        <Heading>\n          <div className=\" hover:text-green-500 hover:translate-x-2 transition-all duration-100\">\n          <a\n            href=\"/\"\n          >\n            Caderneta Digital\n          </a>\n          </div>\n        </Heading>\n        <div className=\"flex w-[30%] gap-6 items-center justify-end\">\n          <div className=\"flex items-center justify-center gap-2\">\n            <Text size=\"md\" >{userData?.name}</Text>\n            {userData?.photoURL !== null ? (\n              <div className=\"shadow-md shadow-black rounded-full\">\n                <img\n                  className=\"rounded-full w-10 ring-2 ring-green-500\"\n                  src={userData?.photoURL}\n                  alt=\"User Image from Google Account\"\n                  referrerPolicy=\"no-referrer\"\n                />\n              </div>\n            ) : null}\n          </div>\n          <div className=\"\">\n            <Button size=\"sm\" onClick={logout}>\n              Sair\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  } else {\n    return (\n      <div>\n        <Loading />\n      </div>\n    );\n  }\n}\n"],"names":["SchoolsContext","createContext","SchoolsContextProvider","children","user","useAuthState","auth","isLoading","setIsLoading","useState","schoolData","setSchoolData","handleWithSchoolDataFromDb","userId","docCollectionRef","collection","db","q","query","where","querySnapshot","getDocs","doc2","schoolName","address","schoolId","__name","handleDeleteSchoolFromDB","deleteDoc","doc","console","alert","location","useEffect","_jsx","useSchool","context","useContext","Header","userData","useUser","navigate","useNavigate","logout","signOut","photoURL","currentUser","Heading","_jsxs","Text","name","Button","Loading"],"mappings":"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"}